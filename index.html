<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>LearnPac Online Training Services</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
  <link rel="icon" type="image/x-icon" href="./assets/images/lplogo.png">
  <link rel="stylesheet" href="style/index.css">

  <!-- NProgress -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.css">
</head>
<body>

<!-- Header -->
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm fixed-top">
  <div class="container">
    <a class="navbar-brand" href="#">
      <img src="./assets/images/lplogo.png" alt="Logo" width="150">
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="mainNav">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0 align-items-center">
        <li class="nav-item"><a class="nav-link" href="?content=Home">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="?content=About">About Us</a></li>
        <li class="nav-item"><a class="nav-link" href="?content=Services">Services</a></li>
        <li class="nav-item"><a class="nav-link" href="?content=Courses">Courses</a></li>
        <li class="nav-item"><a class="nav-link" href="?content=Contacts">Contact</a></li>
        <li class="nav-item">
          <form class="d-flex align-items-center position-relative search-form" id="navbar-search-form" autocomplete="off">
            <div class="search-container">
              <input type="text" class="form-control search-input" placeholder="Search courses..." aria-label="Search" id="search-input">
              <button type="submit" class="btn btn-link search-btn">
                <i class="fas fa-search"></i>
              </button>
            </div>
          </form>
        </li>
        <li class="nav-item">
          <a class="btn btn-outline-primary me-2 login-btn" href="https://app.learnpac.co.uk/log-in/" target="_blank">
            <i class="fas fa-user me-1"></i>Login
          </a>
        </li>
        <li class="nav-item position-relative">
          <button class="btn btn-link position-relative cart-btn">
            <i class="fas fa-shopping-cart"></i>
            <span class="cart-count">0</span>
          </button>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div id="main">Loading...</div>

<!-- Chat Widget -->
<div class="chat-widget" id="chatWidget">
  <div class="chat-minimized">
    <i class="fas fa-robot"></i>
    <span class="notification-badge">1</span>
    <div class="tooltip-message">Hi! I'm LP üëã<br>Need help? Click me!</div>
  </div>
  <div class="chat-expanded">
    <div class="chat-header">
      <div class="d-flex align-items-center">
        <i class="fas fa-robot me-2"></i>
        <span>AI Assistant</span>
      </div>
      <div class="chat-header-actions">
        <button class="btn-new-chat" title="Start new chat">
          <i class="fas fa-plus"></i>
        </button>
        <button class="btn-close btn-close-white"></button>
      </div>
    </div>
    <div class="chat-body" id="chatBody">
      <div class="chat-messages" id="chatMessages">
        <!-- Messages will be added here dynamically -->
      </div>
      <div class="chat-input">
        <input type="text" id="chatInput" placeholder="Type your message...">
        <button>
          <i class="fas fa-paper-plane"></i>
        </button>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.js"></script>
<script>
  // Start NProgress on page load
  document.addEventListener('DOMContentLoaded', () => {
    NProgress.start();
  });

  window.addEventListener('load', () => {
    NProgress.done();
  });

  // Handle search form submission
  document.getElementById('navbar-search-form').addEventListener('submit', function(e) {
    e.preventDefault(); // Prevent form submission
    const searchTerm = document.getElementById('search-input').value;
    if (searchTerm.trim()) {
      // Navigate to courses page with search term
      history.pushState({ content: 'Courses' }, '', '?content=Courses');
      loadContent('Courses', searchTerm);
    }
  });

  // Load content by name with NProgress
  function loadContent(content, searchTerm = '') {
    NProgress.start(); // Show loading progress
    const pageMap = {
      Home: "./html/home.html",
      About: "./html/about-us.html",
      Contact: "pages/contact.html",
      Services: "./html/services.html",
      Courses: "./html/courses.html",
      Contacts: "./html/contact.html"
    };

    const page = pageMap[content] || null;

    if (page) {
      fetch(page)
        .then(res => res.ok ? res.text() : Promise.reject("Page not found"))
        .then(html => {
          const main = document.getElementById("main");
          main.innerHTML = html;

          // Re-execute any scripts inside the loaded HTML
          main.querySelectorAll("script").forEach(oldScript => {
            const newScript = document.createElement("script");
            if (oldScript.src) {
              newScript.src = oldScript.src;
            } else {
              newScript.textContent = oldScript.textContent;
            }
            document.body.appendChild(newScript);
            oldScript.remove();
          });

          // Call page-specific initializer if defined
          if (content === 'Courses' && typeof window.initializeCourses === 'function') {
            window.initializeCourses(searchTerm);
          }

          // Update nav link active state
          document.querySelectorAll('.nav-link').forEach(link => {
            const href = link.getAttribute('href');
            if (href && href.startsWith('?content=')) {
              const linkContent = new URLSearchParams(href.split('?')[1]).get("content");
              link.classList.toggle('active', linkContent === content);
            }
          });
        })
        .catch(err => {
          document.getElementById("main").innerHTML = "<h1>404 - Page Not Found</h1>";
          console.error(err);
        })
        .finally(() => {
          NProgress.done(); // Hide loading progress once content is loaded
        });
    } else {
      document.getElementById("main").innerHTML = "<h1>404 - Page Not Found</h1>";
      NProgress.done();
    }
  }

  // Intercept nav clicks and manage history
  document.addEventListener('DOMContentLoaded', () => {
    const initialContent = new URLSearchParams(window.location.search).get("content") || "Home";
    loadContent(initialContent);

    document.querySelectorAll('a.nav-link').forEach(link => {
      link.addEventListener('click', function (e) {
        const href = this.getAttribute('href');
        if (href && href.startsWith('?content=')) {
          e.preventDefault();
          const content = new URLSearchParams(href.split('?')[1]).get("content");
          history.pushState({ content }, '', href);
          loadContent(content);
        }
      });
    });
  });

  window.addEventListener('popstate', event => {
    const content = (event.state && event.state.content) || new URLSearchParams(window.location.search).get("content") || "Home";
    loadContent(content);
  });
</script>

<!-- Trustpilot Reviews Section -->
<section class="trustpilot-reviews py-5">
  <div class="container">
    <div class="text-center mb-5">
      <h2 class="fw-bold">What Our Customers Say</h2>
      <p class="text-muted">Trusted by thousands of learners worldwide</p>
      <div class="trustpilot-rating d-flex align-items-center justify-content-center gap-2 mb-4">
        <div class="stars">
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="fas fa-star-half-alt"></i>
        </div>
        <span class="rating-text">4.5 out of 5</span>
        <img src="https://consumer.trustpilot.com/images/trustpilot-logo.svg" alt="Trustpilot" height="20" class="ms-2">
      </div>
    </div>

    <div class="row g-4">
      <!-- Review Card 1 -->
      <div class="col-lg-4 col-md-6">
        <div class="review-card">
          <div class="review-header d-flex align-items-center mb-3">
            <div class="reviewer-avatar">
              <img src="https://ui-avatars.com/api/?name=John+Doe&background=007bff&color=fff" alt="John Doe" class="rounded-circle">
            </div>
            <div class="reviewer-info ms-3">
              <h6 class="mb-0">John Doe</h6>
              <div class="stars">
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
              </div>
            </div>
            <div class="review-date ms-auto text-muted">
              <small>2 days ago</small>
            </div>
          </div>
          <p class="review-text">"Excellent course content and very professional delivery. The platform is user-friendly and the support team is always helpful. Highly recommended!"</p>
          <div class="review-footer">
            <span class="course-name">Health & Safety Training</span>
          </div>
        </div>
      </div>

      <!-- Review Card 2 -->
      <div class="col-lg-4 col-md-6">
        <div class="review-card">
          <div class="review-header d-flex align-items-center mb-3">
            <div class="reviewer-avatar">
              <img src="https://ui-avatars.com/api/?name=Sarah+Smith&background=28a745&color=fff" alt="Sarah Smith" class="rounded-circle">
            </div>
            <div class="reviewer-info ms-3">
              <h6 class="mb-0">Sarah Smith</h6>
              <div class="stars">
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
              </div>
            </div>
            <div class="review-date ms-auto text-muted">
              <small>1 week ago</small>
            </div>
          </div>
          <p class="review-text">"The customer service is outstanding! They helped me choose the right course for my career development. The learning materials are comprehensive and well-structured."</p>
          <div class="review-footer">
            <span class="course-name">Business Management</span>
          </div>
        </div>
      </div>

      <!-- Review Card 3 -->
      <div class="col-lg-4 col-md-6">
        <div class="review-card">
          <div class="review-header d-flex align-items-center mb-3">
            <div class="reviewer-avatar">
              <img src="https://ui-avatars.com/api/?name=Michael+Brown&background=dc3545&color=fff" alt="Michael Brown" class="rounded-circle">
            </div>
            <div class="reviewer-info ms-3">
              <h6 class="mb-0">Michael Brown</h6>
              <div class="stars">
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="far fa-star"></i>
              </div>
            </div>
            <div class="review-date ms-auto text-muted">
              <small>2 weeks ago</small>
            </div>
          </div>
          <p class="review-text">"Great platform for professional development. The courses are up-to-date and the certification process is straightforward. Would definitely use their services again."</p>
          <div class="review-footer">
            <span class="course-name">IT Certification</span>
          </div>
        </div>
      </div>
    </div>

    <div class="text-center mt-5">
      <a href="https://www.trustpilot.com/review/learnpac.co.uk" target="_blank" class="btn btn-outline-primary">
        <i class="fas fa-star me-2"></i>Read More Reviews
      </a>
    </div>
  </div>
</section>

<!-- Footer -->
<footer class="footer-dark py-5">
  <div class="container">
    <!-- Newsletter Section -->
    <div class="newsletter-section text-center mb-5">
      <div class="newsletter-content">
        <h2 class="fw-bold text-white mb-3">Stay Updated with LearnPac</h2>
        <p class="text-white-50 mb-4">Subscribe to our newsletter for the latest courses, updates, and exclusive offers.</p>
        <form class="newsletter-form d-flex justify-content-center gap-2">
          <div class="input-group" style="max-width: 500px;">
            <input type="email" class="form-control" placeholder="Enter your email address">
            <button class="btn btn-brand">Subscribe</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Main Footer Content -->
    <div class="row g-4">
      <!-- Company Info -->
      <div class="col-lg-4 col-md-6">
        <div class="footer-brand mb-4">
          <img src="./assets/images/lplogo.png" alt="LearnPac Logo" class="mb-3" width="150">
          <p class="text-white-50">Empowering organizations with accredited online training solutions and professional qualifications. Join thousands of learners worldwide.</p>
        </div>
        <div class="social-icons d-flex gap-3 mb-4">
          <a href="https://www.facebook.com/mandatorytraininguk?_rdc=1&_rdr#" target="_blank" class="social-icon" aria-label="Facebook">
            <i class="fab fa-facebook-f"></i>
          </a>
          <a href="https://twitter.com/MandTrainUK" target="_blank" class="social-icon" aria-label="Twitter">
            <i class="fab fa-x-twitter"></i>
          </a>
          <a href="https://www.instagram.com/mandatorytraininguk/" target="_blank" class="social-icon" aria-label="Instagram">
            <i class="fab fa-instagram"></i>
          </a>
          <a href="https://www.linkedin.com/company/mandatory-training/" target="_blank" class="social-icon" aria-label="LinkedIn">
            <i class="fab fa-linkedin-in"></i>
          </a>

          <a href="https://www.youtube.com/channel/UCucDcqLVddEIE64tcomy4Fg" target="_blank" class="social-icon" aria-label="Youtube">
            <i class="fab fa-youtube"></i>
          </a>

          <a href="https://www.tiktok.com/@mandatorytraininguk" target="_blank" class="social-icon" aria-label="Tiktok">
            <i class="fab fa-tiktok"></i>
          </a>
        </div>
      </div>

      <!-- Quick Links -->
      <div class="col-lg-2 col-md-6">
        <h6 class="text-white mb-3 fw-bold footer-heading">Quick Links</h6>
        <ul class="list-unstyled footer-links">
          <li><a href="?content=Home"><i class="fas fa-chevron-right"></i> Home</a></li>
          <li><a href="?content=About"><i class="fas fa-chevron-right"></i> About Us</a></li>
          <li><a href="?content=Services"><i class="fas fa-chevron-right"></i> Services</a></li>
          <li><a href="?content=Courses"><i class="fas fa-chevron-right"></i> Courses</a></li>
          <li><a href="?content=Contacts"><i class="fas fa-chevron-right"></i> Contact</a></li>
        </ul>
      </div>

      <!-- Resources -->
      <div class="col-lg-2 col-md-6">
        <h6 class="text-white mb-3 fw-bold footer-heading">Resources</h6>
        <ul class="list-unstyled footer-links">
          <li><a href="#"><i class="fas fa-chevron-right"></i> Blog</a></li>
          <li><a href="#"><i class="fas fa-chevron-right"></i> Support Center</a></li>
          <li><a href="#"><i class="fas fa-chevron-right"></i> FAQs</a></li>
          <li><a href="#"><i class="fas fa-chevron-right"></i> Student Portal</a></li>
          <li><a href="#"><i class="fas fa-chevron-right"></i> Career Opportunities</a></li>
        </ul>
      </div>

      <!-- Contact Info -->
      <div class="col-lg-4 col-md-6">
        <h6 class="text-white mb-3 fw-bold footer-heading">Contact Us</h6>
        <ul class="list-unstyled footer-links contact-info">
          <li class="d-flex align-items-center mb-3">
            <div class="contact-icon">
              <i class="fas fa-phone-alt"></i>
            </div>
            <div class="contact-details">
              <span class="text-white-50 d-block">Phone</span>
              <a href="tel:+44123456789">+44 123 456 789</a>
            </div>
          </li>
          <li class="d-flex align-items-center mb-3">
            <div class="contact-icon">
              <i class="fas fa-envelope"></i>
            </div>
            <div class="contact-details">
              <span class="text-white-50 d-block">Email</span>
              <a href="mailto:info@learnpac.co.uk">info@learnpac.co.uk</a>
            </div>
          </li>
          <li class="d-flex align-items-start mb-3">
            <div class="contact-icon">
              <i class="fas fa-map-marker-alt"></i>
            </div>
            <div class="contact-details">
              <span class="text-white-50 d-block">Address</span>
              <span>123 Business Street<br>London, UK<br>SW1A 1AA</span>
            </div>
          </li>
        </ul>
      </div>
    </div>

    <!-- Bottom Footer -->
    <div class="footer-bottom mt-5 pt-4">
      <div class="row align-items-center">
        <div class="col-md-6 text-center text-md-start">
          <p class="text-white-50 mb-0">&copy; 2024 LearnPac. All rights reserved.</p>
          <div class="visitor-counter mt-2">
            <i class="fas fa-eye"></i>
            <span id="visitCount">0</span> visitors
          </div>
        </div>
        <div class="col-md-6 text-center text-md-end mt-3 mt-md-0">
          <div class="d-flex justify-content-center justify-content-md-end gap-3">
            <a href="#" class="text-white-50 text-decoration-none">Privacy Policy</a>
            <a href="#" class="text-white-50 text-decoration-none">Terms of Service</a> 
          </div>
        </div>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="script/search.js"></script>

<script>
// Enhanced Chat Widget Functionality
const chatWidget = {
  isOpen: false,
  messages: [],
  typingTimeout: null,
  maxMessages: 50,
  markdown: null,
  tooltipMessages: [
    "Hi! I'm LP üëã\nNeed help? Click me!",
    "Hey there! üëã\nLet's chat about courses!",
    "Hello! üåü\nI can help you find the perfect course!",
    "Hi friend! ü§ñ\nAsk me anything about training!",
    "Need guidance? üéì\nI'm here to help!",
    "Want to learn? üìö\nLet's explore together!",
    "Hello! üí´\nYour learning journey starts here!",
    "Hi! üöÄ\nReady to discover new courses?"
  ],
  currentTooltipIndex: 0,
  tooltipInterval: null,
  quickReplies: [
    "Tell me about your courses",
    "What are your prices?",
    "How do I get started?",
    "I need technical support"
  ],
  reactions: ['üëç', '‚ù§Ô∏è', 'üòä', 'üëè', 'üéâ'],

  async init() {
    // Load marked.js for markdown support
    if (!this.markdown) {
      await this.loadMarked();
    }
    this.bindEvents();
    this.loadMessages();
    this.startTooltipRotation();
    
    // Show notification badge initially
    this.showNotification();
  },

  async loadMarked() {
    return new Promise((resolve, reject) => {
      const script = document.createElement('script');
      script.src = 'https://cdn.jsdelivr.net/npm/marked/marked.min.js';
      script.onload = () => {
        this.markdown = marked;
        resolve();
      };
      script.onerror = reject;
      document.head.appendChild(script);
    });
  },

  bindEvents() {
    const widget = document.getElementById('chatWidget');
    const input = document.getElementById('chatInput');
    const sendButton = document.querySelector('.chat-input button');
    const closeButton = document.querySelector('.chat-header .btn-close');
    const minimizedButton = document.querySelector('.chat-minimized');
    const newChatButton = document.querySelector('.btn-new-chat');

    // Ensure widget starts minimized
    widget.classList.add('minimized');
    this.isOpen = false;

    minimizedButton?.addEventListener('click', (e) => {
      e.preventDefault();
      e.stopPropagation();
      this.toggleChat();
    });

    closeButton?.addEventListener('click', (e) => {
      e.preventDefault();
      e.stopPropagation();
      this.toggleChat();
    });

    newChatButton?.addEventListener('click', () => this.startNewChat());

    input?.addEventListener('keypress', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        this.sendMessage();
      }
    });

    sendButton?.addEventListener('click', () => this.sendMessage());

    // Prevent chat expansion from closing when clicking inside
    const chatExpanded = widget?.querySelector('.chat-expanded');
    chatExpanded?.addEventListener('click', (e) => e.stopPropagation());
  },

  toggleChat() {
    const widget = document.getElementById('chatWidget');
    this.isOpen = !this.isOpen;
    
    if (this.isOpen) {
      widget.classList.remove('minimized');
      this.hideNotification();
      this.scrollToBottom();
      this.stopTooltipRotation();
    } else {
      widget.classList.add('minimized');
      this.startTooltipRotation();
    }
  },

  hideNotification() {
    const badge = document.querySelector('.notification-badge');
    if (badge) {
      badge.style.display = 'none';
    }
  },

  showNotification() {
    const badge = document.querySelector('.notification-badge');
    if (badge) {
      badge.style.display = 'flex';
    }
  },

  async sendMessage() {
    const input = document.getElementById('chatInput');
    const message = input.value.trim();
    
    if (message) {
      try {
        // Add user message
        this.addMessage(message, 'user');
        input.value = '';
        
        // Show typing indicator
        this.showTypingIndicator();
        
        // Simulate API call delay
        await new Promise(resolve => setTimeout(resolve, 1000));
        
        // Remove typing indicator
        this.removeTypingIndicator();
        
        // Generate and add bot response
        const response = await this.generateResponse(message);
        this.addMessage(response, 'bot');
        
        // Save messages
        this.saveMessages();
      } catch (error) {
        console.error('Error sending message:', error);
        this.addErrorMessage('Sorry, there was an error processing your message. Please try again.');
      }
    }
  },

  showTypingIndicator() {
    const messages = document.getElementById('chatMessages');
    const typingDiv = document.createElement('div');
    typingDiv.className = 'message bot';
    typingDiv.innerHTML = `
      <div class="typing-indicator">
        <span></span>
        <span></span>
        <span></span>
      </div>
    `;
    messages.appendChild(typingDiv);
    this.scrollToBottom();
  },

  removeTypingIndicator() {
    const typingIndicator = document.querySelector('.typing-indicator');
    if (typingIndicator) {
      typingIndicator.parentElement.remove();
    }
  },

  addMessage(text, type) {
    const messages = document.getElementById('chatMessages');
    const messageDiv = document.createElement('div');
    messageDiv.className = `message ${type}`;
    
    // Format timestamp
    const timestamp = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
    
    // Convert markdown to HTML if it's a bot message
    const formattedText = type === 'bot' && this.markdown ? 
      this.markdown.parse(text.replace(/\n/g, '<br>')) : 
      text.replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\n/g, '<br>');
    
    // Add message actions
    const actions = type === 'bot' ? `
      <div class="message-actions">
        <button class="message-action-btn" onclick="chatWidget.copyMessage(this)">
          <i class="fas fa-copy"></i> Copy
        </button>
        <button class="message-action-btn" onclick="chatWidget.thumbsUp(this)">
          <i class="fas fa-thumbs-up"></i> Helpful
        </button>
      </div>
    ` : '';
    
    // Add quick replies for bot messages
    const quickReplies = type === 'bot' ? this.generateQuickReplies(text) : '';
    
    messageDiv.innerHTML = `
      <div class="message-content">${formattedText}</div>
      <div class="message-timestamp">${timestamp}</div>
      ${actions}
      ${quickReplies}
    `;
    
    messages.appendChild(messageDiv);
    
    this.messages.push({ 
      text, 
      type, 
      timestamp: new Date().toISOString(),
      reactions: []
    });
    
    // Limit stored messages
    if (this.messages.length > this.maxMessages) {
      this.messages = this.messages.slice(-this.maxMessages);
    }
    
    this.scrollToBottom();
  },

  generateQuickReplies(message) {
    // Only show quick replies for certain types of messages
    if (message.includes('How can I assist you today?') || 
        message.includes('What would you like to know more about?')) {
      return `
        <div class="quick-replies">
          ${this.quickReplies.map(reply => `
            <button class="quick-reply-btn" onclick="chatWidget.useQuickReply('${reply}')">
              ${reply}
            </button>
          `).join('')}
        </div>
      `;
    }
    return '';
  },

  useQuickReply(text) {
    const input = document.getElementById('chatInput');
    input.value = text;
    this.sendMessage();
  },

  copyMessage(button) {
    const messageContent = button.closest('.message').querySelector('.message-content');
    const text = messageContent.textContent;
    
    navigator.clipboard.writeText(text).then(() => {
      const originalText = button.innerHTML;
      button.innerHTML = '<i class="fas fa-check"></i> Copied!';
      setTimeout(() => {
        button.innerHTML = originalText;
      }, 2000);
    });
  },

  thumbsUp(button) {
    button.classList.toggle('active');
    const message = button.closest('.message');
    const messageIndex = Array.from(message.parentNode.children).indexOf(message);
    
    if (button.classList.contains('active')) {
      this.messages[messageIndex].reactions.push('üëç');
    } else {
      this.messages[messageIndex].reactions = 
        this.messages[messageIndex].reactions.filter(r => r !== 'üëç');
    }
    
    this.saveMessages();
  },

  addErrorMessage(text) {
    const messages = document.getElementById('chatMessages');
    const errorDiv = document.createElement('div');
    errorDiv.className = 'error-message';
    errorDiv.innerHTML = `
      <i class="fas fa-exclamation-circle"></i>
      <span>${text}</span>
    `;
    messages.appendChild(errorDiv);
    this.scrollToBottom();
  },

  scrollToBottom() {
    const messages = document.getElementById('chatMessages');
    messages.scrollTop = messages.scrollHeight;
  },

  async generateResponse(message) {
    // Enhanced response generation with more context and better formatting
    const lowerMessage = message.toLowerCase();
    
    const responses = {
      greeting: {
        patterns: ['hello', 'hi', 'hey', 'good morning', 'good afternoon', 'good evening'],
        response: "Hello! üëã I'm LP, your AI assistant. I can help you with:\n\n" +
                 "‚Ä¢ Course information and pricing\n" +
                 "‚Ä¢ Training program details\n" +
                 "‚Ä¢ Technical support\n" +
                 "‚Ä¢ General inquiries\n\n" +
                 "How can I assist you today?"
      },
      courses: {
        patterns: ['course', 'training', 'learn', 'study', 'program'],
        response: "We offer a wide range of courses! Here are some popular categories:\n\n" +
                 "‚Ä¢ Professional Certifications\n" +
                 "‚Ä¢ Technical Skills\n" +
                 "‚Ä¢ Business & Management\n" +
                 "‚Ä¢ Health & Safety\n\n" +
                 "Would you like to know more about any specific category?"
      },
      pricing: {
        patterns: ['price', 'cost', 'fee', 'payment', 'how much'],
        response: "Our course prices vary based on the program and duration. Here's a general guide:\n\n" +
                 "| Course Type | Price Range |\n" +
                 "|------------|-------------|\n" +
                 "| Individual courses | ¬£50-¬£200 |\n" +
                 "| Certification programs | ¬£200-¬£500 |\n" +
                 "| Corporate training | Custom pricing |\n\n" +
                 "Would you like to see our current course catalog with detailed pricing?"
      },
      help: {
        patterns: ['help', 'support', 'assist', 'trouble', 'problem'],
        response: "I'm here to help! You can:\n\n" +
                 "1. Ask about specific courses\n" +
                 "2. Get pricing information\n" +
                 "3. Learn about our training methods\n" +
                 "4. Get technical support\n\n" +
                 "What would you like to know more about?"
      },
      technical: {
        patterns: ['technical', 'support', 'help', 'issue', 'problem'],
        response: "For technical support, you can:\n\n" +
                 "1. Check our [Knowledge Base](https://support.learnpac.co.uk)\n" +
                 "2. Contact our support team at support@learnpac.co.uk\n" +
                 "3. Call our support line at +44 123 456 789\n\n" +
                 "What specific issue are you experiencing?"
      }
    };

    // Check for matching patterns
    for (const [key, data] of Object.entries(responses)) {
      if (data.patterns.some(pattern => lowerMessage.includes(pattern))) {
        return data.response;
      }
    }
    
    // Default response with suggestions
    return "I understand you're interested in learning more. Here are some topics I can help with:\n\n" +
           "‚Ä¢ Course information and enrollment\n" +
           "‚Ä¢ Training program details\n" +
           "‚Ä¢ Pricing and payment options\n" +
           "‚Ä¢ Technical support\n\n" +
           "Please let me know what specific information you need!";
  },

  saveMessages() {
    try {
      localStorage.setItem('chatMessages', JSON.stringify(this.messages));
    } catch (error) {
      console.error('Error saving messages:', error);
      // If storage is full, remove oldest messages
      if (error.name === 'QuotaExceededError') {
        this.messages = this.messages.slice(-this.maxMessages);
        this.saveMessages();
      }
    }
  },

  loadMessages() {
    try {
      const savedMessages = localStorage.getItem('chatMessages');
      if (savedMessages) {
        this.messages = JSON.parse(savedMessages);
        this.messages.forEach(msg => {
          this.addMessage(msg.text, msg.type);
        });
      } else {
        // Add welcome message if no saved messages
        const welcomeMessage = "Hi there! üëã I'm LP, your AI assistant. I can help you with:\n\n" +
                             "‚Ä¢ Course information and pricing\n" +
                             "‚Ä¢ Training program details\n" +
                             "‚Ä¢ Technical support\n" +
                             "‚Ä¢ General inquiries\n\n" +
                             "How can I assist you today?";
        this.messages = [{ text: welcomeMessage, type: 'bot', timestamp: new Date().toISOString() }];
        this.addMessage(welcomeMessage, 'bot');
      }
    } catch (error) {
      console.error('Error loading messages:', error);
      this.addErrorMessage('Error loading chat history. Starting fresh conversation.');
    }
  },

  startNewChat() {
    // Clear messages array
    this.messages = [];
    
    // Clear chat messages container
    const messagesContainer = document.getElementById('chatMessages');
    if (messagesContainer) {
      messagesContainer.innerHTML = '';
    }
    
    // Add welcome message
    const welcomeMessage = "Hi there! üëã I'm LP, your AI assistant. I can help you with:\n\n" +
                         "‚Ä¢ Course information and pricing\n" +
                         "‚Ä¢ Training program details\n" +
                         "‚Ä¢ Technical support\n" +
                         "‚Ä¢ General inquiries\n\n" +
                         "How can I assist you today?";
    
    this.messages.push({ 
      text: welcomeMessage, 
      type: 'bot', 
      timestamp: new Date().toISOString() 
    });
    
    this.addMessage(welcomeMessage, 'bot');
    
    // Save empty chat history
    this.saveMessages();
    
    // Show success message
    this.addSystemMessage('New chat started');
  },

  addSystemMessage(text) {
    const messages = document.getElementById('chatMessages');
    const messageDiv = document.createElement('div');
    messageDiv.className = 'system-message';
    messageDiv.innerHTML = `
      <div class="message-content">${text}</div>
    `;
    messages.appendChild(messageDiv);
    this.scrollToBottom();
  },

  startTooltipRotation() {
    const minimizedButton = document.querySelector('.chat-minimized');
    if (minimizedButton) {
      // Set initial tooltip
      minimizedButton.setAttribute('data-tooltip', this.tooltipMessages[0]);
      
      // Start rotation with fade effect
      this.tooltipInterval = setInterval(() => {
        const tooltipElement = minimizedButton.querySelector('.tooltip-message');
        if (tooltipElement) {
          tooltipElement.style.opacity = '0';
          
          setTimeout(() => {
            this.currentTooltipIndex = (this.currentTooltipIndex + 1) % this.tooltipMessages.length;
            tooltipElement.textContent = this.tooltipMessages[this.currentTooltipIndex];
            tooltipElement.style.opacity = '1';
          }, 300); // Fade out duration
        }
      }, 6000); // Change message every 6 seconds
    }
  },

  stopTooltipRotation() {
    if (this.tooltipInterval) {
      clearInterval(this.tooltipInterval);
      const tooltipElement = document.querySelector('.tooltip-message');
      if (tooltipElement) {
        tooltipElement.style.opacity = '1';
      }
    }
  },
};

// Initialize chat widget when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
  chatWidget.init();
});

// Add cart functionality
let cart = [];

// Load cart from server
async function loadCart() {
    try {
        const response = await fetch('data/cart_operations.php?action=get_cart');
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        const contentType = response.headers.get('content-type');
        if (!contentType || !contentType.includes('application/json')) {
            throw new Error('Server did not return JSON');
        }
        const data = await response.json();
        
        if (data.success) {
            cart = data.cart;
            updateCartCount();
            displayCart();
        } else {
            console.warn('Cart data not in expected format:', data);
            cart = [];
            updateCartCount();
            displayCart();
        }
    } catch (error) {
        console.error('Error loading cart:', error);
        // Initialize empty cart on error
        cart = [];
        updateCartCount();
        displayCart();
    }
}

// Display cart items
function displayCart() {
    const cartItems = document.getElementById('cartItems');
    const cartTotal = document.getElementById('cartTotal');
    const cartSubtotal = document.getElementById('cartSubtotal');
    const cartItemCount = document.getElementById('cartItemCount');
    
    if (!cartItems || !cartTotal) return;
    
    if (cart.length === 0) {
        cartItems.innerHTML = `
            <div class="empty-cart text-center py-4">
                <i class="fas fa-shopping-cart fa-3x text-muted mb-3"></i>
                <p class="text-muted">Your cart is empty</p>
            </div>
        `;
        cartTotal.textContent = '0.00';
        cartSubtotal.textContent = '0.00';
        cartItemCount.textContent = '0';
        return;
    }

    let total = 0;
    let itemCount = 0;
    cartItems.innerHTML = '';

    cart.forEach(item => {
        const itemTotal = item.price * item.quantity;
        total += itemTotal;
        itemCount += item.quantity;
        
        cartItems.innerHTML += `
            <div class="cart-item d-flex align-items-center p-3 border-bottom">
                <img src="${item.image}" alt="${item.title}" class="cart-item-image me-3" 
                     onerror="this.src='https://placehold.co/50x50?text=${encodeURIComponent(item.title)}'">
                <div class="cart-item-info flex-grow-1">
                    <h6 class="cart-item-title mb-1">${item.title}</h6>
                    <div class="cart-item-price text-primary">¬£${item.price.toFixed(2)}</div>
                    <div class="quantity-controls d-flex align-items-center mt-2">
                        <button class="btn btn-sm btn-outline-secondary" onclick="updateQuantity(${item.id}, ${item.quantity - 1})">
                            <i class="fas fa-minus"></i>
                        </button>
                        <span class="mx-2">${item.quantity}</span>
                        <button class="btn btn-sm btn-outline-secondary" onclick="updateQuantity(${item.id}, ${item.quantity + 1})">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                </div>
                <div class="cart-item-actions">
                    <div class="cart-item-total mb-2">¬£${itemTotal.toFixed(2)}</div>
                    <button class="btn btn-sm btn-outline-danger" onclick="removeFromCart(${item.id})">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </div>
        `;
    });

    cartTotal.textContent = total.toFixed(2);
    cartSubtotal.textContent = total.toFixed(2);
    cartItemCount.textContent = itemCount;
}

// Update quantity
async function updateQuantity(courseId, newQuantity) {
    if (newQuantity < 1) return;
    
    try {
        const response = await fetch('data/cart_operations.php', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                action: 'update',
                course_id: courseId,
                quantity: newQuantity
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            await loadCart(); // Reload cart after updating quantity
        } else {
            throw new Error(data.error || 'Failed to update quantity');
        }
    } catch (error) {
        console.error('Error updating quantity:', error);
        alert('Failed to update quantity. Please try again.');
    }
}

// Remove from cart
async function removeFromCart(courseId) {
    try {
        const response = await fetch('data/cart_operations.php', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                action: 'remove',
                course_id: courseId
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            await loadCart(); // Reload cart after removing item
        } else {
            throw new Error(data.error || 'Failed to remove item from cart');
        }
    } catch (error) {
        console.error('Error removing from cart:', error);
        alert('Failed to remove item from cart. Please try again.');
    }
}

// Update cart count in navbar
function updateCartCount() {
    const cartCount = document.querySelector('.cart-count');
    if (cartCount) {
        cartCount.textContent = cart.length;
    }
}

// Checkout function
function checkout() {
    if (cart.length === 0) {
        alert('Your cart is empty!');
        return;
    }
    alert('Thank you for your purchase! This is a demo, so no actual payment will be processed.');
    cart = [];
    updateCartCount();
    const cartModal = bootstrap.Modal.getInstance(document.getElementById('cartModal'));
    cartModal.hide();
}

// Initialize cart when page loads
document.addEventListener('DOMContentLoaded', () => {
    loadCart();
    
    // Setup cart button click handler
    const cartBtn = document.querySelector('.cart-btn');
    if (cartBtn) {
        cartBtn.addEventListener('click', () => {
            displayCart();
            const cartModal = new bootstrap.Modal(document.getElementById('cartModal'));
            cartModal.show();
        });
    }
});

// Visitor Counter Functionality
function updateVisitCount() {
  // Get current count from localStorage
  let count = localStorage.getItem('visitCount') || 0;
  count = parseInt(count) + 1;
  
  // Save updated count
  localStorage.setItem('visitCount', count);
  
  // Update display with animation
  const visitCountElement = document.getElementById('visitCount');
  if (visitCountElement) {
    visitCountElement.style.opacity = '0';
    visitCountElement.style.transform = 'translateY(10px)';
    
    setTimeout(() => {
      visitCountElement.textContent = count.toLocaleString();
      visitCountElement.style.opacity = '1';
      visitCountElement.style.transform = 'translateY(0)';
    }, 200);
  }
}

// Initialize visit count on page load
document.addEventListener('DOMContentLoaded', () => {
  updateVisitCount();
  
  // Add animation styles
  const style = document.createElement('style');
  style.textContent = `
    #visitCount {
      transition: all 0.3s ease;
    }
  `;
  document.head.appendChild(style);
});

// Clear cart
async function clearCart() {
    if (!confirm('Are you sure you want to clear your cart?')) return;
    
    try {
        const response = await fetch('data/cart_operations.php', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                action: 'clear'
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            await loadCart(); // Reload cart after clearing
        } else {
            throw new Error(data.error || 'Failed to clear cart');
        }
    } catch (error) {
        console.error('Error clearing cart:', error);
        alert('Failed to clear cart. Please try again.');
    }
}
</script>


<!-- Add Cart Modal -->
<div class="modal fade" id="cartModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Shopping Cart</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div id="cartItems">
          <!-- Cart items will be dynamically loaded here -->
        </div>
        <div class="cart-summary mt-3 pt-3 border-top">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <span>Subtotal:</span>
            <span>¬£<span id="cartSubtotal">0.00</span></span>
          </div>
          <div class="d-flex justify-content-between align-items-center mb-2">
            <span>Items:</span>
            <span id="cartItemCount">0</span>
          </div>
          <div class="d-flex justify-content-between align-items-center fw-bold">
            <span>Total:</span>
            <span>¬£<span id="cartTotal">0.00</span></span>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-danger" onclick="clearCart()">
          <i class="fas fa-trash me-1"></i>Clear Cart
        </button>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" onclick="checkout()">
          <i class="fas fa-shopping-cart me-1"></i>Proceed to Checkout
        </button>
      </div>
    </div>
  </div>
</div>

<style>
/* Header and Navbar Styles */
.navbar {
  padding: 0.8rem 0;
  transition: all 0.3s ease;
}

.navbar-brand img {
  transition: transform 0.3s ease;
}

.navbar-brand:hover img {
  transform: scale(1.05);
}

.nav-link {
  font-weight: 500;
  padding: 0.5rem 1rem !important;
  color: #333 !important;
  transition: color 0.3s ease;
}

.nav-link:hover {
  color: #007bff !important;
}

.nav-link.active {
  color: #007bff !important;
}

/* Search Form Styles */
.search-form {
  margin: 0 1rem;
  width: 250px;
}

.search-container {
  position: relative;
  width: 100%;
}

.search-input {
  border-radius: 25px;
  padding: 0.6rem 1rem 0.6rem 2.5rem;
  border: 1px solid #e0e0e0;
  background: #f8f9fa;
  font-size: 0.95rem;
  width: 100%;
}

.search-input:focus {
  background: #fff;
  border-color: #007bff;
  box-shadow: 0 0 0 0.2rem rgba(0,123,255,0.15);
  outline: none;
}

.search-btn {
  position: absolute;
  left: 0.8rem;
  top: 50%;
  transform: translateY(-50%);
  color: #6c757d;
  padding: 0;
  font-size: 0.9rem;
  background: none;
  border: none;
}

.search-btn:hover {
  color: #007bff;
}

/* Search Results Dropdown */
.search-results-dropdown {
  position: absolute;
  top: calc(100% + 0.5rem);
  left: 0;
  right: 0;
  background: white;
  border-radius: 12px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.1);
  margin-top: 0.5rem;
  z-index: 1000;
  max-height: 400px;
  overflow-y: auto;
  border: 1px solid #e0e0e0;
}

.search-results-content {
  padding: 0.5rem;
}

.search-result-item {
  display: flex;
  align-items: center;
  padding: 0.8rem;
  border-radius: 8px;
  transition: background-color 0.2s ease;
  cursor: pointer;
}

.search-result-item:hover {
  background-color: #f8f9fa;
}

.search-result-item img {
  width: 45px;
  height: 45px;
  object-fit: cover;
  border-radius: 6px;
  margin-right: 1rem;
}

.search-result-item .course-info {
  flex-grow: 1;
}

.search-result-item .course-title {
  font-weight: 500;
  margin-bottom: 0.2rem;
  color: #333;
  font-size: 0.95rem;
}

.search-result-item .course-price {
  color: #28a745;
  font-weight: 500;
  font-size: 0.9rem;
}

.search-result-item .add-to-cart-btn {
  padding: 0.5rem 1rem;
  background: #007bff;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 0.9rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.search-result-item .add-to-cart-btn:hover {
  background: #0056b3;
  transform: translateY(-1px);
}

/* Login Button */
.login-btn {
  padding: 0.5rem 1.2rem;
  border-radius: 25px;
  font-weight: 500;
  transition: all 0.3s ease;
}

.login-btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(0,123,255,0.15);
}

/* Cart Button */
.cart-btn {
  color: #333;
  padding: 0.5rem;
  font-size: 1.2rem;
  transition: all 0.3s ease;
}

.cart-btn:hover {
  color: #007bff;
  transform: translateY(-1px);
}

.cart-count {
  position: absolute;
  top: -5px;
  right: -5px;
  background: #dc3545;
  color: white;
  border-radius: 50%;
  width: 20px;
  height: 20px;
  font-size: 0.75rem;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 500;
}

/* Loading Animation */
.search-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 1rem;
  color: #666;
}

.search-loading::after {
  content: '';
  width: 16px;
  height: 16px;
  border: 2px solid #007bff;
  border-top-color: transparent;
  border-radius: 50%;
  margin-left: 0.5rem;
  animation: spin 0.8s linear infinite;
}

/* No Results Styling */
.no-results {
  text-align: center;
  padding: 1.5rem;
  color: #666;
}

.no-results i {
  font-size: 2rem;
  color: #ddd;
  margin-bottom: 0.5rem;
}

.no-results p {
  margin: 0;
  font-size: 0.9rem;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

/* Responsive Adjustments */
@media (max-width: 991.98px) {
  .search-form {
    margin: 1rem 0;
    width: 250px;
  }
  
  .navbar-nav {
    padding: 1rem 0;
  }
  
  .nav-link {
    padding: 0.5rem 0 !important;
  }
  
  .login-btn {
    margin: 0.5rem 0;
    width: 100%;
    text-align: center;
  }
}

/* Ensure chat widget is visible */
.chat-widget {
  position: fixed;
  bottom: 20px;
  right: 20px;
  z-index: 9999;
  display: block !important;
}

.chat-widget.minimized .chat-expanded {
  display: none !important;
}

.chat-widget:not(.minimized) .chat-minimized {
  display: none !important;
}

.chat-minimized {
  width: 60px;
  height: 60px;
  background: linear-gradient(135deg, #007bff, #0056b3);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  position: relative;
  transition: transform 0.3s ease;
}

.chat-minimized i {
  color: white;
  font-size: 24px;
  z-index: 2;
}

.tooltip-message {
  position: absolute;
  right: 70px;
  top: 50%;
  transform: translateY(-50%);
  background: white;
  padding: 10px 15px;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  font-size: 14px;
  color: #333;
  white-space: pre-line;
  z-index: 1000;
  text-align: center;
  min-width: 180px;
  transition: opacity 0.3s ease;
}

.tooltip-message::after {
  content: '';
  position: absolute;
  right: -8px;
  top: 50%;
  transform: translateY(-50%);
  border: 8px solid transparent;
  border-left-color: white;
}

/* Add animation for the tooltip */
@keyframes tooltipPulse {
  0% { transform: translateY(-50%) scale(1); }
  50% { transform: translateY(-50%) scale(1.05); }
  100% { transform: translateY(-50%) scale(1); }
}

.tooltip-message {
  animation: tooltipPulse 2s infinite;
}

/* Add hover effect for the chat button */
.chat-minimized:hover {
  transform: scale(1.05);
  box-shadow: 0 6px 16px rgba(0,0,0,0.2);
}

.chat-minimized:hover i {
  transform: scale(1.1);
}

.notification-badge {
  position: absolute;
  top: -5px;
  right: -5px;
  background: #dc3545;
  color: white;
  border-radius: 50%;
  width: 20px;
  height: 20px;
  font-size: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); }
}

.chat-expanded {
  width: 350px;
  height: 500px;
  background: white;
  border-radius: 12px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.15);
  display: flex;
  flex-direction: column;
  transform: translateY(0);
  opacity: 1;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.chat-header {
  background: linear-gradient(135deg, #007bff, #0056b3);
  color: white;
  padding: 15px;
  border-radius: 12px 12px 0 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.chat-body {
  flex: 1;
  display: flex;
  flex-direction: column;
  padding: 15px;
  background: #f8f9fa;
  height: calc(100% - 60px); /* Subtract header height */
  overflow: hidden; /* Prevent double scrollbars */
}

.chat-messages {
  flex: 1;
  overflow-y: auto;
  margin-bottom: 15px;
  padding: 10px;
  height: 100%; /* Ensure full height */
  -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
}

/* Add scrollbar styling */
.chat-messages::-webkit-scrollbar {
  width: 6px;
}

.chat-messages::-webkit-scrollbar-track {
  background: #f1f1f1;
  border-radius: 3px;
}

.chat-messages::-webkit-scrollbar-thumb {
  background: #888;
  border-radius: 3px;
}

.chat-messages::-webkit-scrollbar-thumb:hover {
  background: #555;
}

.message {
  margin-bottom: 15px;
  display: flex;
  flex-direction: column;
  animation: messageSlide 0.3s ease;
}

@keyframes messageSlide {
  from { transform: translateY(10px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

.message.user {
  align-items: flex-end;
}

.message.bot {
  align-items: flex-start;
}

.message-content {
  max-width: 80%;
  padding: 12px 16px;
  border-radius: 15px;
  font-size: 14px;
  line-height: 1.5;
  position: relative;
}

.message.user .message-content {
  background: linear-gradient(135deg, #007bff, #0056b3);
  color: white;
  border-radius: 15px 15px 0 15px;
}

.message.bot .message-content {
  background: white;
  color: #333;
  border-radius: 15px 15px 15px 0;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
}

.message-timestamp {
  font-size: 11px;
  color: #666;
  margin-top: 4px;
  opacity: 0.8;
}

.chat-input {
  display: flex;
  gap: 10px;
  padding: 10px;
  background: white;
  border-radius: 12px;
  box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
}

.chat-input input {
  flex: 1;
  padding: 12px;
  border: 1px solid #dee2e6;
  border-radius: 8px;
  font-size: 14px;
  transition: all 0.3s ease;
}

.chat-input input:focus {
  outline: none;
  border-color: #007bff;
  box-shadow: 0 0 0 0.2rem rgba(0,123,255,0.15);
}

.chat-input button {
  background: linear-gradient(135deg, #007bff, #0056b3);
  color: white;
  border: none;
  border-radius: 8px;
  padding: 12px 20px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.chat-input button:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(0,123,255,0.2);
}

.chat-input button:active {
  transform: translateY(0);
}

/* Enhanced typing indicator */
.typing-indicator {
  display: flex;
  gap: 4px;
  padding: 12px 16px;
  background: white;
  border-radius: 15px;
  width: fit-content;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
}

.typing-indicator span {
  width: 8px;
  height: 8px;
  background: #007bff;
  border-radius: 50%;
  animation: typing 1s infinite ease-in-out;
}

.typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
.typing-indicator span:nth-child(3) { animation-delay: 0.4s; }

@keyframes typing {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}

/* Markdown styling */
.message-content p {
  margin: 0 0 10px 0;
}

.message-content p:last-child {
  margin-bottom: 0;
}

.message-content code {
  background: rgba(0,0,0,0.1);
  padding: 2px 4px;
  border-radius: 4px;
  font-family: monospace;
}

.message-content pre {
  background: rgba(0,0,0,0.1);
  padding: 10px;
  border-radius: 8px;
  overflow-x: auto;
  margin: 10px 0;
}

.message-content ul, .message-content ol {
  margin: 10px 0;
  padding-left: 20px;
}

.message-content li {
  margin: 5px 0;
}

/* Error message styling */
.error-message {
  background: #fff3f3;
  color: #dc3545;
  padding: 10px;
  border-radius: 8px;
  margin: 10px 0;
  font-size: 13px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.error-message i {
  font-size: 16px;
}

/* Additional Chat Widget Styles */
.message-actions {
  display: flex;
  gap: 8px;
  margin-top: 4px;
  opacity: 0;
  transition: opacity 0.2s ease;
}

.message:hover .message-actions {
  opacity: 1;
}

.message-action-btn {
  background: none;
  border: none;
  color: #666;
  font-size: 12px;
  padding: 2px 6px;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.message-action-btn:hover {
  background: rgba(0,0,0,0.05);
  color: #007bff;
}

.quick-replies {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 10px;
}

.quick-reply-btn {
  background: white;
  border: 1px solid #dee2e6;
  border-radius: 15px;
  padding: 6px 12px;
  font-size: 13px;
  color: #333;
  cursor: pointer;
  transition: all 0.2s ease;
}

.quick-reply-btn:hover {
  background: #f8f9fa;
  border-color: #007bff;
  color: #007bff;
}

.message-reactions {
  display: flex;
  gap: 4px;
  margin-top: 4px;
}

.reaction-btn {
  background: none;
  border: none;
  padding: 2px 6px;
  border-radius: 12px;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.reaction-btn:hover {
  background: rgba(0,0,0,0.05);
}

.reaction-btn.active {
  background: rgba(0,123,255,0.1);
  color: #007bff;
}

/* Loading animation */
.loading-dots {
  display: inline-flex;
  gap: 4px;
  align-items: center;
}

.loading-dots span {
  width: 4px;
  height: 4px;
  background: currentColor;
  border-radius: 50%;
  animation: loadingDots 1.4s infinite ease-in-out both;
}

.loading-dots span:nth-child(1) { animation-delay: -0.32s; }
.loading-dots span:nth-child(2) { animation-delay: -0.16s; }

@keyframes loadingDots {
  0%, 80%, 100% { transform: scale(0); }
  40% { transform: scale(1); }
}

/* Message status indicators */
.message-status {
  font-size: 11px;
  color: #666;
  margin-top: 2px;
  display: flex;
  align-items: center;
  gap: 4px;
}

.message-status i {
  font-size: 10px;
}

/* Enhanced message content */
.message-content {
  position: relative;
}

.message-content::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border-radius: inherit;
  pointer-events: none;
  transition: opacity 0.2s ease;
  opacity: 0;
}

.message-content:hover::before {
  opacity: 0.05;
  background: currentColor;
}

/* Code block styling */
.message-content pre {
  background: rgba(0,0,0,0.05);
  padding: 12px;
  border-radius: 8px;
  overflow-x: auto;
  margin: 10px 0;
  font-size: 13px;
  line-height: 1.5;
}

.message-content code {
  font-family: 'Fira Code', monospace;
  font-size: 13px;
}

/* Link styling */
.message-content a {
  color: #007bff;
  text-decoration: none;
  border-bottom: 1px solid transparent;
  transition: border-color 0.2s ease;
}

.message-content a:hover {
  border-bottom-color: currentColor;
}

/* List styling */
.message-content ul {
  list-style-type: none;
  padding-left: 0;
}

.message-content ul li {
  position: relative;
  padding-left: 20px;
  margin: 8px 0;
}

.message-content ul li::before {
  content: '‚Ä¢';
  position: absolute;
  left: 0;
  color: #007bff;
}

/* Table styling */
.message-content table {
  width: 100%;
  border-collapse: collapse;
  margin: 10px 0;
  font-size: 13px;
}

.message-content th,
.message-content td {
  padding: 8px;
  border: 1px solid #dee2e6;
  text-align: left;
}

.message-content th {
  background: #f8f9fa;
  font-weight: 600;
}

/* Blockquote styling */
.message-content blockquote {
  border-left: 3px solid #007bff;
  margin: 10px 0;
  padding: 10px 15px;
  background: rgba(0,123,255,0.05);
  border-radius: 0 8px 8px 0;
}

/* Horizontal rule */
.message-content hr {
  border: none;
  border-top: 1px solid #dee2e6;
  margin: 15px 0;
}

.chat-header-actions {
  display: flex;
  align-items: center;
  gap: 10px;
}

.btn-new-chat {
  background: none;
  border: none;
  color: white;
  padding: 5px;
  cursor: pointer;
  transition: all 0.2s ease;
  border-radius: 50%;
  width: 30px;
  height: 30px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.btn-new-chat:hover {
  background: rgba(255, 255, 255, 0.1);
  transform: scale(1.1);
}

.btn-new-chat i {
  font-size: 14px;
}

.system-message {
  text-align: center;
  margin: 10px 0;
}

.system-message .message-content {
  display: inline-block;
  background: rgba(0, 0, 0, 0.05);
  color: #666;
  padding: 5px 15px;
  border-radius: 15px;
  font-size: 12px;
}

/* Enhanced Footer Styles */
.footer-dark {
  background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
  color: #fff;
  position: relative;
  overflow: hidden;
}

.footer-dark::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, #007bff, #00d2ff);
}

.newsletter-section {
  position: relative;
  padding: 3rem 0;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 15px;
  margin-bottom: 3rem;
  backdrop-filter: blur(10px);
}

.newsletter-content {
  max-width: 800px;
  margin: 0 auto;
  padding: 0 1rem;
}

.newsletter-form .form-control {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: #fff;
  padding: 0.8rem 1.2rem;
  border-radius: 8px 0 0 8px;
  transition: all 0.3s ease;
}

.newsletter-form .form-control:focus {
  background: rgba(255, 255, 255, 0.15);
  border-color: rgba(255, 255, 255, 0.3);
  box-shadow: none;
}

.newsletter-form .form-control::placeholder {
  color: rgba(255, 255, 255, 0.6);
}

.newsletter-form .btn-brand {
  padding: 0.8rem 1.5rem;
  border-radius: 0 8px 8px 0;
  font-weight: 500;
  background: linear-gradient(135deg, #007bff, #00d2ff);
  border: none;
  transition: all 0.3s ease;
}

.newsletter-form .btn-brand:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
}

.footer-heading {
  position: relative;
  padding-bottom: 10px;
}

.footer-heading::after {
  content: '';
  position: absolute;
  left: 0;
  bottom: 0;
  width: 40px;
  height: 2px;
  background: linear-gradient(90deg, #007bff, #00d2ff);
}

.social-icon {
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 50%;
  color: #fff;
  transition: all 0.3s ease;
  text-decoration: none;
}

.social-icon:hover {
  background: linear-gradient(135deg, #007bff, #00d2ff);
  color: #fff;
  transform: translateY(-3px);
  box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
}

.footer-links li {
  margin-bottom: 0.8rem;
}

.footer-links a {
  color: rgba(255, 255, 255, 0.7);
  text-decoration: none;
  transition: all 0.3s ease;
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

.footer-links a:hover {
  color: #fff;
  transform: translateX(5px);
}

.footer-links i {
  font-size: 0.8rem;
  color: #007bff;
  transition: all 0.3s ease;
}

.footer-links a:hover i {
  transform: translateX(3px);
}

.contact-info .contact-icon {
  width: 40px;
  height: 40px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: 15px;
  color: #007bff;
}

.contact-info .contact-details {
  flex: 1;
}

.contact-info .contact-details a {
  color: #fff;
  text-decoration: none;
  transition: all 0.3s ease;
}

.contact-info .contact-details a:hover {
  color: #007bff;
}

.footer-bottom {
  position: relative;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.footer-bottom a {
  position: relative;
  transition: all 0.3s ease;
}

.footer-bottom a:hover {
  color: #fff !important;
}

.footer-bottom a::after {
  content: '';
  position: absolute;
  left: 0;
  bottom: -2px;
  width: 0;
  height: 1px;
  background: #007bff;
  transition: width 0.3s ease;
}

.footer-bottom a:hover::after {
  width: 100%;
}

@media (max-width: 768px) {
  .newsletter-section {
    padding: 2rem 1rem;
  }
  
  .newsletter-form .input-group {
    flex-direction: column;
  }
  
  .newsletter-form .btn-brand {
    border-radius: 8px;
    margin-top: 1rem;
  }
  
  .footer-links {
    margin-bottom: 2rem;
  }
  
  .contact-info {
    margin-bottom: 2rem;
  }
}

/* Visitor Counter Styles */
.visitor-counter {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  background: rgba(255, 255, 255, 0.1);
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 0.9rem;
  color: rgba(255, 255, 255, 0.7);
  transition: all 0.3s ease;
}

.visitor-counter:hover {
  background: rgba(255, 255, 255, 0.15);
  color: #fff;
}

.visitor-counter i {
  color: #007bff;
}

#visitCount {
  font-weight: 600;
  color: #fff;
}

@media (max-width: 768px) {
  .visitor-counter {
    margin-top: 1rem;
  }
}

/* Trustpilot Reviews Styles */
.trustpilot-reviews {
  background: #f8f9fa;
  position: relative;
  overflow: hidden;
}

.trustpilot-reviews::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, #007bff, #00d2ff);
}

.trustpilot-rating {
  margin-top: 1rem;
}

.trustpilot-rating .stars {
  color: #00b67a;
  font-size: 1.2rem;
}

.trustpilot-rating .rating-text {
  font-weight: 600;
  color: #333;
}

.review-card {
  background: white;
  border-radius: 12px;
  padding: 1.5rem;
  height: 100%;
  box-shadow: 0 4px 15px rgba(0,0,0,0.05);
  transition: all 0.3s ease;
  border: 1px solid rgba(0,0,0,0.05);
}

.review-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 25px rgba(0,0,0,0.1);
}

.reviewer-avatar img {
  width: 45px;
  height: 45px;
  object-fit: cover;
}

.reviewer-info .stars {
  color: #ffb800;
  font-size: 0.9rem;
}

.review-text {
  color: #555;
  font-size: 0.95rem;
  line-height: 1.6;
  margin-bottom: 1rem;
}

.review-footer {
  border-top: 1px solid #eee;
  padding-top: 1rem;
  margin-top: auto;
}

.course-name {
  color: #007bff;
  font-size: 0.9rem;
  font-weight: 500;
}

.btn-outline-primary {
  padding: 0.8rem 1.5rem;
  border-radius: 25px;
  font-weight: 500;
  transition: all 0.3s ease;
}

.btn-outline-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(0,123,255,0.2);
}

@media (max-width: 768px) {
  .review-card {
    margin-bottom: 1rem;
  }
  
  .trustpilot-rating {
    flex-direction: column;
    gap: 0.5rem;
  }
}

/* Cart Item Styles */
.cart-item {
    transition: all 0.3s ease;
}

.cart-item:hover {
    background-color: #f8f9fa;
}

.cart-item-image {
    width: 60px;
    height: 60px;
    object-fit: cover;
    border-radius: 8px;
}

.cart-item-title {
    font-size: 0.95rem;
    margin-bottom: 0.25rem;
}

.cart-item-price {
    font-size: 0.9rem;
    font-weight: 500;
}

.cart-item-total {
    font-weight: 600;
    color: #28a745;
}

.quantity-controls {
    background: #f8f9fa;
    border-radius: 20px;
    padding: 2px;
}

.quantity-controls button {
    width: 28px;
    height: 28px;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
}

.quantity-controls span {
    min-width: 30px;
    text-align: center;
    font-weight: 500;
}

.cart-summary {
    background: #f8f9fa;
    padding: 1rem;
    border-radius: 8px;
}

.empty-cart {
    padding: 2rem;
}

.empty-cart i {
    color: #dee2e6;
}
</style>
</body>
</html>
